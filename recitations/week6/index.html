
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This page contains the recitation materials for Week 6 of the Deep Reinforcement Learning course. You can find links to the recitation recordings and slides.">
      
      
      
        <link rel="canonical" href="https://deeprlcourse.github.io/recitations/week6/">
      
      
        <link rel="prev" href="../week5/">
      
      
        <link rel="next" href="../week7/">
      
      
      <link rel="icon" href="../../assets/favicon/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Week 6: Multi-Armed Bandits - Deep RL Course</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRed+Hat+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Red Hat Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/vazirmatn.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-Q1YT8K39WE"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-Q1YT8K39WE",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-Q1YT8K39WE",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Week 6: Multi-Armed Bandits - Deep RL Course" >
      
        <meta  property="og:description"  content="This page contains the recitation materials for Week 6 of the Deep Reinforcement Learning course. You can find links to the recitation recordings and slides." >
      
        <meta  property="og:image"  content="https://deeprlcourse.github.io/assets/images/social/recitations/week6.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://deeprlcourse.github.io/recitations/week6/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Week 6: Multi-Armed Bandits - Deep RL Course" >
      
        <meta  name="twitter:description"  content="This page contains the recitation materials for Week 6 of the Deep Reinforcement Learning course. You can find links to the recitation recordings and slides." >
      
        <meta  name="twitter:image"  content="https://deeprlcourse.github.io/assets/images/social/recitations/week6.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#week-6-multi-armed-bandits" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Deep RL Course" class="md-header__button md-logo" aria-label="Deep RL Course" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Deep RL Course
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Week 6: Multi-Armed Bandits
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../home/calender/" class="md-tabs__link">
          
  
  
  Calendar

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../course_notes/intro-to-rl/" class="md-tabs__link">
          
  
  
  Course Notes

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lectures/week1/" class="md-tabs__link">
          
  
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guests/richard_sutton/" class="md-tabs__link">
          
  
  
  Guests

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../week1/" class="md-tabs__link">
          
  
  
  Recitations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../workshops/week1/" class="md-tabs__link">
          
  
  
  Workshops

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../homeworks/week1/" class="md-tabs__link">
          
  
  
  Homeworks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../prerequisites/deep_learning/" class="md-tabs__link">
          
  
  
  Prerequisites

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../exams/midterm/" class="md-tabs__link">
          
  
  
  Exams

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../journal_club/" class="md-tabs__link">
          
  
  
  Journal Club

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../poster_session/" class="md-tabs__link">
          
  
  
  Poster Session

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../resources/" class="md-tabs__link">
          
  
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
    
      

    

    

        

            

        

            

        
    

    


    <!-- Navigation -->
    
        
        <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="sidebar"
            data-md-type="navigation"
            
        >
            <div class="md-sidebar__scrollwrap">
            <div class="md-sidebar__inner">
                <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Determine classes -->


  


  
    
  


<!-- Navigation -->
<nav
  class="md-nav md-nav--primary md-nav--lifted md-nav--integrated"
  aria-label="Navigation"
  data-md-level="0"
>

  <!-- Site title -->
  <label class="md-nav__title" for="__drawer">
    <a
      href="../.."
      title="Deep RL Course"
      class="md-nav__button md-logo"
      aria-label="Deep RL Course"
      data-md-component="logo"
    >
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Deep RL Course
  </label>

  <!-- Repository information -->
  

  <!-- Navigation list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Calendar
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Calendar
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../home/calender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calender
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conceptual Overview of RL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Conceptual Overview of RL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/intro-to-rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 1: Introduction to RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/value-based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 2: Value-based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/policy-based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 3: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 4: Advanced Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/model-based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 5: Model-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/bandits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 6: Multi-Armed Bandits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RL Methods in Depth
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            RL Methods in Depth
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/intro-to-phase2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to RL in Depth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/value-based2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 7: Value-based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/policy-based2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 8: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/exploration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exploration Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/imitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Imitation Learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inverse RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/offline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Offline RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/multi-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Agent RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/hierarchical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hierarchical RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course_notes/meta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Meta-RL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lectures
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 1: Introduction to RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 2: Value-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 3: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 4: Advanced Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 5: Model-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 6: Multi-Armed Bandits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 7: Value-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 8: Policy-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 9: Advanced Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 10: Exploration Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 11: Imitation &amp; Inverse RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 12: Offline Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 13: Multi-Agent Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 14: Hierarchical &amp; Meta RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lectures/week15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 15: Guest Lectures
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guests
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Guests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/richard_sutton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Richard Sutton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/chris_watkins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chris Watkins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/michael_littman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Michael Littman
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/peter_stone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Peter Stone
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/jakob_foerster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jakob Foerster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/nan_jiang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nan Jiang
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/benjamin_eysenbach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benjamin Eysenbach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/ian_osband/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ian Osband
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/jeff_clune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jeff Clune
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/peter_dayan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Peter Dayan
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/ida_momennejad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ida Momennejad
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/abhishek_gupta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abhishek Gupta
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/benjamin_van_roy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benjamin Van Roy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/wolfram_schultz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wolfram Schultz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/mark_ho/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mark Ho
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/pascal_poupart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pascal Poupart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/peter_norvig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Peter Norvig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/karl_friston/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Karl Friston
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/amy_zhang/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amy Zhang
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/adam_white/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adam White
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/anne_collins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anne Collins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/luis_serrano/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Luis Serrano
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/martha_white/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Martha White
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/christopher_amato/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Christopher Amato
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guests/marlos_machado/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Marlosâ€¯C. Machado
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Recitations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Recitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 1: Introduction to RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 2: Value-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 3: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 4: Advanced Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 5: Model-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Week 6: Multi-Armed Bandits
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Week 6: Multi-Armed Bandits
    
  </span>
  

      </a>
      
        <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine title -->




<!-- Table of contents -->
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  

  <!--
    Check whether the content starts with a level 1 headline. If it does, the
    top-level anchor must be skipped, since it would be redundant to the link
    to the current page that is located just above the anchor. Therefore we
    directly continue with the children of the anchor.
  -->
  
  
    
  

  <!-- Table of contents title and list -->
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#screen-record" class="md-nav__link">
    <span class="md-ellipsis">
      Screen Record
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recitation-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Recitation Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recitation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-definition-of-the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      1. Definition of the Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Definition of the Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-associativity-property" class="md-nav__link">
    <span class="md-ellipsis">
      Non-Associativity Property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-world-applications-of-mab" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Applications of MAB
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-action-value-methods-and-types" class="md-nav__link">
    <span class="md-ellipsis">
      2. Action-Value Methods and Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Action-Value Methods and Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#incremental-update-rule-for-efficient-computation" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental Update Rule for Efficient Computation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Incremental Update Rule for Efficient Computation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#derivation" class="md-nav__link">
    <span class="md-ellipsis">
      Derivation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant-step-size-update-for-nonstationary-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Constant Step-Size Update (For Nonstationary Problems)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constant Step-Size Update (For Nonstationary Problems)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exponential-weighted-averaging" class="md-nav__link">
    <span class="md-ellipsis">
      Exponential Weighted Averaging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-regret-measuring-suboptimality" class="md-nav__link">
    <span class="md-ellipsis">
      3. Regret: Measuring Suboptimality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-exploration-exploitation-dilemma-and-uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      4. Exploration-Exploitation Dilemma and Uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-exploration-strategies-in-bandits" class="md-nav__link">
    <span class="md-ellipsis">
      5. Exploration Strategies in Bandits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Exploration Strategies in Bandits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-epsilon-greedy-exploration" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. \(\epsilon\)-Greedy Exploration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-optimistic-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Optimistic Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-ucb" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 UCB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-thompson-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Thompson Sampling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-contextual-bandits" class="md-nav__link">
    <span class="md-ellipsis">
      6. Contextual Bandits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authors" class="md-nav__link">
    <span class="md-ellipsis">
      Author(s)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 7: Value-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 8: Policy-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 9: Advanced Theory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Workshops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 1: Introduction to RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 2: Value-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 3: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 4: Advanced Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 5: Model-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshops/week6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 6: Multi-Armed Bandits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Homeworks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Homeworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW1: Introduction to RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW2: Value-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW3: Policy-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW4: Advanced Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW5: Model-Based Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW6: Multi-Armed Bandits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW7: Value-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW8: Policy-Based Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW9: Advanced Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW10: Exploration Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW11: Imitation &amp; Inverse RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW12: Offline Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW13: Multi-Agent Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/week14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HW14: Hierarchical &amp; Meta RL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../homeworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Previous Semesters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prerequisites
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Prerequisites
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/deep_learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep Learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/game_theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Game Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/linear_algebra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/numerical_optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numerical Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/information_theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Information Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/stochastic_processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stochastic Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Exams
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Exams
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exams/midterm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spring 2025 Midterm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exams/final/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spring 2025 Final
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Previous Semesters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Journal Club
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Journal Club
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../journal_club/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Journal Club
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Poster Session
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Poster Session
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../poster_session/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poster Session
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../poster_session/sp24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spring 2024
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_3" >
        
          
          <label class="md-nav__link" for="__nav_14_3" id="__nav_14_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_3">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/archive/2025/02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    February 2025
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14_4" >
        
          
          <label class="md-nav__link" for="__nav_14_4" id="__nav_14_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_14_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14_4">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/category/course-updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course Updates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
            </div>
            </div>
        </div>
    

    <!-- Table of contents -->
    

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="week-6-multi-armed-bandits">Week 6: Multi-Armed Bandits</h1>
<h3 id="screen-record">Screen Record</h3>
<iframe width="996" height="560" src="https://www.youtube.com/embed/cE7WaT7dLIY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<hr />
<h3 id="recitation-notes">Recitation Notes</h3>
<h4 id="1-definition-of-the-problem"><strong>1. Definition of the Problem</strong></h4>
<p>The <em>multi-armed bandit</em> problem is a very simple model that we can investigate
to better understand the exploration/exploitation tradeoff. In this MDP, we have
no state, but only actions and a reward function, i.e. <span class="arithmatex">\((\mathcal{A, R})\)</span>. Here,
<span class="arithmatex">\(\mathcal{A}\)</span> is a finite set of actions ("bandit arms"), while <span class="arithmatex">\(\mathcal{R}\)</span> is
a distribution over rewards for actions: <span class="arithmatex">\(\mathcal{R}^a(r) = \Pr[R = r | A =
a]\)</span>. At each step, then, the agent selects an action <span class="arithmatex">\(A_t \in \mathcal{A}\)</span> and
the environment generates a reward ("payout") <span class="arithmatex">\(R_t \sim \mathcal{R}^{A_t}\)</span>. The
goal, as always, is to maximize the cumulative reward <span class="arithmatex">\(\sum_{\tau=1}^t
R_{\tau}\)</span>.</p>
<p><img alt="Figure 1" src="/assets/images/recitation/week6/1.png" /></p>
<p>We can define a few more functions and variables in this setup. The
<em>action-value</em> (Q-value) of an action is the mean reward for that action:</p>
<div class="arithmatex">\[q(a) = \mathbb{E}[R | A = a].\]</div>
<p>Furthermore, there exists <strong>one</strong> optimal value <span class="arithmatex">\(v_{\star}\)</span>, which is the
Q-value of the best action <span class="arithmatex">\(a^{\star}\)</span>:</p>
<div class="arithmatex">\[v_\star = q(a^\star) = \max_{a \in \mathcal{A}} q(a).\]</div>
<p>The difficulty lies in the fact that the agent does not initially know the reward distributions of the arms. It must balance <strong>exploration</strong> (gathering information about unknown arms) and <strong>exploitation</strong> (choosing the best-known arm) to optimize long-term gains.</p>
<p>Formally, the MAB problem consists of:</p>
<ul>
<li>A <strong>finite action set</strong> <span class="arithmatex">\(\mathcal{A}\)</span> with <span class="arithmatex">\(k\)</span> possible actions.</li>
<li>A <strong>reward distribution</strong> <span class="arithmatex">\(\mathcal{R}^a\)</span> for each action <span class="arithmatex">\(a\)</span> where <span class="arithmatex">\(R_t \sim \mathcal{R}^{A_t}\)</span> represents the reward obtained at time <span class="arithmatex">\(t\)</span>.</li>
<li>The objective is to maximize the <strong>cumulative reward</strong> over <span class="arithmatex">\(T\)</span> steps:</li>
</ul>
<div class="arithmatex">\[
G_T = \sum_{t=1}^{T} R_{t}.
\]</div>
<h5 id="non-associativity-property"><strong>Non-Associativity Property</strong></h5>
<ul>
<li>Unlike <strong>full reinforcement learning problems</strong>, <strong>multi-armed bandits are non-associative</strong>.</li>
<li>This means that <strong>the best action does not depend on the state</strong>; the optimal action is the same for all time steps.</li>
<li>Formally, we do <strong>not</strong> consider state transitions: The bandit setting <strong>only involves selecting actions</strong> and receiving rewards, without any long-term effects from past decisions.</li>
</ul>
<p>Unlike full Markov Decision Processes (MDPs), the MAB setting does not involve state transitions, meaning the agent must learn optimal actions purely through repeated trials.</p>
<h5 id="real-world-applications-of-mab"><strong>Real-World Applications of MAB</strong></h5>
<p>The MAB framework is used in several fields:</p>
<ul>
<li><strong>Medical Trials:</strong> Identifying the best treatment while minimizing patient risk.</li>
<li><strong>Online Advertising:</strong> Choosing optimal ad placements for revenue maximization.</li>
<li><strong>Recommendation Systems:</strong> Dynamically selecting personalized content.</li>
<li><strong>Financial Investments:</strong> Allocating assets to maximize returns under uncertainty.</li>
</ul>
<h4 id="2-action-value-methods-and-types">2. Action-Value Methods and Types</h4>
<p>To solve the MAB problem, we need a way to estimate action values. The <strong>action-value function</strong> <span class="arithmatex">\(Q_t(a)\)</span> estimates the expected reward of choosing action <span class="arithmatex">\(a\)</span> at time step <span class="arithmatex">\(t\)</span>:</p>
<div class="arithmatex">\[
Q_t(a) \approx q_*(a).
\]</div>
<p>We define <strong>sample-average estimation</strong> of <span class="arithmatex">\(Q_t(a)\)</span> as:</p>
<div class="arithmatex">\[
Q_t(a) = \frac{1}{N_t(a)} \sum_{i=1}^{N_t(a)} R_i
\]</div>
<p>where:
- <span class="arithmatex">\(N_t(a)\)</span> is the number of times action <span class="arithmatex">\(a\)</span> has been selected.
- <span class="arithmatex">\(R_i\)</span> is the reward received when selecting <span class="arithmatex">\(a\)</span>.</p>
<h5 id="incremental-update-rule-for-efficient-computation"><strong>Incremental Update Rule for Efficient Computation</strong></h5>
<p>Instead of storing all past rewards, we can update <span class="arithmatex">\(Q_t(a)\)</span> incrementally:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = Q_t(a) + \frac{1}{N_t(a)} (R_t - Q_t(a)).
\]</div>
<h6 id="derivation"><strong>Derivation</strong></h6>
<p>The sample-average estimate at time step <span class="arithmatex">\(t+1\)</span> is:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = \frac{1}{N_{t+1}(a)} \sum_{i=1}^{N_{t+1}(a)} R_i
\]</div>
<p>Expanding this in terms of <span class="arithmatex">\(Q_t(a)\)</span>:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = \frac{1}{N_{t+1}(a)} \left( \sum_{i=1}^{N_t(a)} R_i + R_t \right)
\]</div>
<p>Since <span class="arithmatex">\(Q_t(a)\)</span> is the average of previous rewards:</p>
<div class="arithmatex">\[
Q_t(a) = \frac{1}{N_t(a)} \sum_{i=1}^{N_t(a)} R_i
\]</div>
<p>Multiplying by <span class="arithmatex">\(N_t(a)\)</span>:</p>
<div class="arithmatex">\[
N_t(a) Q_t(a) = \sum_{i=1}^{N_t(a)} R_i
\]</div>
<p>Substituting into the equation:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = \frac{1}{N_{t+1}(a)} \left( N_t(a) Q_t(a) + R_t \right)
\]</div>
<p>Rewriting in update form:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = Q_t(a) + \frac{1}{N_t(a)} (R_t - Q_t(a))
\]</div>
<p>This allows us to update <span class="arithmatex">\(Q_t(a)\)</span> without storing all past rewards.</p>
<h5 id="constant-step-size-update-for-nonstationary-problems"><strong>Constant Step-Size Update (For Nonstationary Problems)</strong></h5>
<p>When dealing with <strong>changing reward distributions</strong>, we use a <strong>constant step-size</strong> <span class="arithmatex">\(\alpha\)</span>:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = Q_t(a) + \alpha (R_t - Q_t(a)).
\]</div>
<p>where <span class="arithmatex">\(\alpha\)</span> determines <strong>how much weight</strong> is given to recent rewards.</p>
<ul>
<li>If <span class="arithmatex">\(\alpha = \frac{1}{N_t(a)}\)</span>, this becomes <strong>sample-average estimation</strong>.</li>
<li>If <span class="arithmatex">\(\alpha\)</span> is <strong>constant</strong>, this results in <strong>exponentially weighted averaging</strong>, useful for <strong>nonstationary problems</strong>.</li>
</ul>
<h6 id="exponential-weighted-averaging"><strong>Exponential Weighted Averaging</strong></h6>
<p>Expanding recursively:</p>
<div class="arithmatex">\[
Q_{t+1}(a) = (1 - \alpha) Q_t(a) + \alpha R_t
\]</div>
<div class="arithmatex">\[
Q_{t+2}(a) = (1 - \alpha) Q_{t+1}(a) + \alpha R_{t+1}
\]</div>
<p>Expanding further:</p>
<div class="arithmatex">\[
Q_{t+2}(a) = (1 - \alpha)^2 Q_t(a) + \alpha (1 - \alpha) R_t + \alpha R_{t+1}
\]</div>
<p>This pattern continues, showing that older rewards have exponentially decaying influence:</p>
<div class="arithmatex">\[
Q_t(a) = (1 - \alpha)^t Q_0(a) + \sum_{i=0}^{t-1} \alpha (1 - \alpha)^i R_{t-i}
\]</div>
<p>which demonstrates the effect of <strong>exponential weighting</strong>.</p>
<h4 id="3-regret-measuring-suboptimality"><strong>3. Regret: Measuring Suboptimality</strong></h4>
<p>Furthermore, we'll now want to investigate a novel quantity known as the
<em>regret</em>. Regret gives us an indication of the opportunity loss for picking a
particular action <span class="arithmatex">\(A_t\)</span> compared to the optimal action <span class="arithmatex">\(a^\star\)</span> In symbols:</p>
<div class="arithmatex">\[
I_t = \mathbb{E}[v_\star - q(A_t)].
\]</div>
<p>Finally, we can define the <em>total regret</em> as the total opportunity loss over an
entire episode:</p>
<div class="arithmatex">\[
L_t = \mathbb{E}\left[\sum_{\tau=1}^t v_\star - q(A_\tau)\right].
\]</div>
<p>The goal of the agent is then to minimize the total regret, which is equivalent
to maximizing the cumulative (total) reward. In addition to the above
definitions, we'll now also keep a count <span class="arithmatex">\(N_t(a)\)</span> which is the <em>expected number
of selections for an action a</em>. Moreover, we define the <em>gap</em> <span class="arithmatex">\(\delta_a\)</span> as
the difference between the <em>expected</em> value <span class="arithmatex">\(q(a)\)</span> of an action a and the
optimal action:</p>
<div class="arithmatex">\[
\Delta_a = v_\star - q(a).
\]</div>
<p>As such, we can give an equivalent definition of the regret <span class="arithmatex">\(L_t\)</span> in terms of
the gap:</p>
<div class="arithmatex">\[
\begin{align}
  L_t &amp;= \mathbb{E}\left[\sum_{\tau=1}^t v_\star - q(A_\tau)\right] \\
      &amp;= \sum_{a \in \mathcal{A}}\mathbb{E}[N_t(a)](v_\star - q(a)) \\
      &amp;= \sum_{a \in \mathcal{A}}\mathbb{E}[N_t(a)]\Delta_a.
\end{align}
\]</div>
<p>Now, if we think of the regret as a function of iterations, we can make some
observations. For example, we observe that the regret of a greedy algorithm <span class="arithmatex">\(A_t = \text{argmax}_{a \in \mathcal{A}} Q_t(a)\)</span> is a linear function, i.e. it increases
linearly with each iteration. The reason why is that we may "lock" onto a
suboptimal action forever, thus adding a certain fixed amount of regret each
time. An alteration that we can make here is to initialize the Q-value of each
action to the maximum reward. This is called <em>optimistic initialization</em>. Note
that updates to <span class="arithmatex">\(Q(a)\)</span> are made via an averaging process:</p>
<div class="arithmatex">\[
Q(a) = \frac{1}{N_t(a)}\sum_{t=1}^T \mathbf{1}(A_t = a)R_t.
\]</div>
<p><img alt="Figure 2" src="/assets/images/recitation/week6/2.png" /></p>
<p>Now, while <span class="arithmatex">\(\varepsilon\)</span>-greedy approaches incur linear regret, certain
strategies that decay <span class="arithmatex">\(\varepsilon\)</span> can actually only incur logarithmic
(asymptotic) regret. Either way, there is actually a lower bound on the regret
that any algorithm can achieve (i.e. no algorithm can do better), which is
logarithmic:</p>
<div class="arithmatex">\[
\lim_{t\rightarrow\infty} L_t \geq \log t \sum_{a \,|\, \Delta_a &gt; 0} \frac{\Delta_A}{\text{KL}(\mathcal{R}^a || \mathcal{R}^{a^\star})}.
\]</div>
<p>As you can see, this lower bound is proportional to the gap size (higher gap
size means higher lower-bound for regret, i.e. more regret) and indirectly
proportional to the similarity of bandits, given by the Kullback-Leibler
divergence.</p>
<h4 id="4-exploration-exploitation-dilemma-and-uncertainty"><strong>4. Exploration-Exploitation Dilemma and Uncertainty</strong></h4>
<p>The <strong>exploration-exploitation tradeoff</strong> is at the heart of MAB problems:</p>
<ul>
<li><strong>Exploitation:</strong> Selecting the action with the highest known reward.</li>
<li><strong>Exploration:</strong> Trying less-known actions to gather new information.</li>
</ul>
<p>Since the agent lacks prior knowledge of the optimal action, exploration is necessary to reduce uncertainty. However, excessive exploration may lead to unnecessary loss of rewards. Finding the right balance is essential for optimal performance.</p>
<h4 id="5-exploration-strategies-in-bandits"><strong>5. Exploration Strategies in Bandits</strong></h4>
<p>Several strategies help balance exploration and exploitation effectively:</p>
<h5 id="51-epsilon-greedy-exploration"><strong>5.1. <span class="arithmatex">\(\epsilon\)</span>-Greedy Exploration</strong></h5>
<p>One of the simplest strategies for exploration is <strong><span class="arithmatex">\(\epsilon\)</span>-greedy</strong>, where:</p>
<ul>
<li>With probability <strong><span class="arithmatex">\(1 - \epsilon\)</span></strong>, we <strong>exploit</strong> by selecting the <strong>best-known action</strong>.</li>
<li>With probability <strong><span class="arithmatex">\(\epsilon\)</span></strong>, we <strong>explore</strong> by selecting a <strong>random action</strong>.</li>
</ul>
<div class="arithmatex">\[
A_t =
\begin{cases}
\arg\max_a Q_t(a), &amp; \text{with probability } 1-\epsilon \\
\text{random } a, &amp; \text{with probability } \epsilon.
\end{cases}
\]</div>
<p>A variation, <strong>decaying <span class="arithmatex">\(\varepsilon\)</span>-greedy</strong>, reduces <span class="arithmatex">\(\varepsilon\)</span> over time to favor exploitation as learning progresses.</p>
<h5 id="52-optimistic-initialization">5.2 Optimistic Initialization</h5>
<p>Optimistic initialization encourages exploration by initializing action-values with an artificially high value:</p>
<div class="arithmatex">\[
Q_1(a) = Q_{  ext{max}}.
\]</div>
<p>This approach works by ensuring that initially, every action appears to be promising, forcing the agent to sample all actions before settling on an optimal choice. The key idea is to assume that each action is better than it actually is, prompting the agent to try them all.</p>
<p>In practice, an optimistic estimate is set as:</p>
<div class="arithmatex">\[
Q_1(a) = R_{\max},
\]</div>
<p>where <span class="arithmatex">\(R_{\max}\)</span> is an upper bound on the highest possible reward. Since the agent updates estimates based on actual experience, actions with lower rewards will eventually have their values corrected downward, while the truly optimal actions will remain highly rated.</p>
<p>Optimistic initialization is particularly effective when:
- The environment is stationary, meaning reward distributions do not change over time.
- The number of actions is small, ensuring each action is explored adequately.
- The upper bound estimate <span class="arithmatex">\(R_{\max}\)</span> is not too high, as overly optimistic values can cause unnecessary exploration.</p>
<p>This method is simple yet effective for balancing exploration and exploitation, particularly when rewards are initially unknown.
method ensures early exploration before settling on the best action.</p>
<h5 id="53-ucb"><strong>5.3 UCB</strong></h5>
<p>A very fundamental idea within the exploration/exploitation domain is that of
<em>optimism in the face of uncertainty</em>. This idea tells us that if we know very
well of the value of one action, but not as well about the value of another
action, but do know that that other value <em>may</em> have a greater value, then we
should go for the other action. So if you imagine a Gaussian distribution for
the first action and a Gaussian for the second, then if the second Gaussian has
a higher tail such that it <em>could</em> have its mean higher than the first Gaussian,
even if the first Gaussian has currently a greater mean (but shorter tail), then
we should pick the second one.</p>
<p><img alt="Figure 3" src="/assets/images/recitation/week6/3.png" />
<img alt="Figure 4" src="/assets/images/recitation/week6/4.png" /></p>
<p>To formalize this idea, we can think of <em>confidence bounds</em>. Let <span class="arithmatex">\(U_t(a)\)</span> be an
upper confidence bound on the value of action <span class="arithmatex">\(a\)</span> at time <span class="arithmatex">\(t\)</span>, such that with
high probability, the expected value <span class="arithmatex">\(q(a)\)</span> is bounded by the current value
<span class="arithmatex">\(Q_t(a)\)</span> plus this bound:</p>
<div class="arithmatex">\[q(a) \geq Q_t(a) + U_t(a).\]</div>
<p>Then what the above paragraph described is equivalent to saying that we should
pick the action with the highest value for <span class="arithmatex">\(Q_t(a) + U_t(a)\)</span>, i.e.</p>
<div class="arithmatex">\[A_t = \text{argmax}_{a \in \mathcal{A}} Q_t(a) + U_t(a).\]</div>
<p>Furthermore, one property of these upper confidence bounds that we require is
that they should get smaller over time, meaning the variance should become
smaller and smaller (the Gaussian becomes thinner).</p>
<p>So how do we find <span class="arithmatex">\(U_t(a)\)</span>? To do this, we'll use <em>Hoeffding's inequality</em>,
which says that for some independently and identically distributed (i.i.d)
random variables <span class="arithmatex">\(X_1, ..., X_t \in [0, 1]\)</span> with sample mean <span class="arithmatex">\(\bar{X} =
\frac{1}{t}\sum_\tau^t X_{\tau}\)</span>, we have</p>
<div class="arithmatex">\[\Pr[\mathbb{E}[X] &gt; \bar{X} + u] \leq e^{-2tu^2}\]</div>
<p>as an upper bound on the probability that the true mean of <span class="arithmatex">\(X\)</span> will be greater
than the sample mean <span class="arithmatex">\(\bar{X}\)</span> plus some value <span class="arithmatex">\(u\)</span>. Differently put, this is an
upper bound on the probability that the difference between the true mean and the
sample mean will be greater than some value <span class="arithmatex">\(u\)</span>. For our purposes, we an plug in
<span class="arithmatex">\(q(a)\)</span> for the expectation (true mean), <span class="arithmatex">\(Q_t(a)\)</span> for the sample mean and our
upper confidence bound <span class="arithmatex">\(U_t(a)\)</span> for the bounding value. This gives us</p>
<div class="arithmatex">\[\Pr[q(a) &gt; Q_t(a) + U_t(a)] \leq e^{-2N_t(a)U_t(a)^2}.\]</div>
<p>We can now use this inequality to solve for <span class="arithmatex">\(U_t(a)\)</span>, giving us a way to compute
this quantity. If we set <span class="arithmatex">\(p\)</span> to be some probability that we want for  our
confidence interval, we get</p>
<div class="arithmatex">\[
\begin{align}
  e^{-2N_t(a)U_t(a)^2} &amp;= p \\
  -2N_t(a)U_t(a)^2 &amp;= \log p \\
  U_t(a)^2 &amp;= \frac{\log p}{-2N_t(a)} \\
  U_t(a) &amp;= \sqrt{\frac{\log p}{-2N_t(a)}}.
\end{align}
\]</div>
<p>As we can see, this gives us precisely the property that we wanted: Since
<span class="arithmatex">\(N_t(a)\)</span> is in the denominator, this upper bound will decrease over time, giving
us more and more certainty about the true mean of the action-value <span class="arithmatex">\(Q(a)\)</span>.</p>
<p>Now that we have a way to compute <span class="arithmatex">\(U_t(a)\)</span>, we know how to pick actions
according to the formula we defined earlier. We can now develop an algorithm to
solve multi-armed bandit problems, called the <em>UCB1</em> algorithm. It picks an
action according</p>
<div class="arithmatex">\[
\begin{align}
  A_t &amp;= \text{argmax}_{a \in \mathcal{A}} Q_t(a) + U_t(a) \\
      &amp;= \text{argmax}_{a \in \mathcal{A}} Q_t(a) + \sqrt{\frac{\log p}{-2N_t(a)}}
\end{align}
\]</div>
<p>This algorithm achieves the logarithmic regret we discussed earlier. Another
algorithm which achieves this bound is called <em>Thompson sampling</em>, which sets
the policy to</p>
<div class="arithmatex">\[\pi(a) = \mathbb{E}[\mathbf{1}(Q(a) = \max_{a'}Q(a')) | R_1,...,R_{t-1}]\]</div>
<p>where use <em>Bayes law</em> to compute a posterior distribution <span class="arithmatex">\(p_{\mathbf{w}}(Q |
R_1,...,R_{t-1})\)</span> and then sample an action-value function <span class="arithmatex">\(Q(a)\)</span> from the
posterior. We then simply pick the action that maximizes the action value
functions.</p>
<h5 id="54-thompson-sampling"><strong>5.4 Thompson Sampling</strong></h5>
<p>Thompson Sampling is a <strong>Bayesian approach</strong> that models action rewards probabilistically:</p>
<div class="arithmatex">\[
A_t = \text{argmax}_{a} Q_t(a), \quad Q_t(a) \sim p(Q | R_1, ..., R_{t-1}).
\]</div>
<p>Thompson Sampling balances exploration and exploitation in an elegant, probabilistic manner and achieves <strong>logarithmic regret</strong>:</p>
<div class="arithmatex">\[
L_T = O(\log T).
\]</div>
<p>The idea is to maintain a <strong>posterior distribution</strong> over the possible reward distributions (or parameters) of each arm and to sample an arm according to the probability it is the best arm. In essence, at each step Thompson Sampling randomizes its action in a way that is proportional to the credibility of each action being optimal given the observed data.</p>
<p><strong>Bayesian Formulation:</strong> Assume a prior distribution for the unknown parameters of each armâ€™s reward distribution. For example, in a Bernoulli bandit (each play is success/failure with some unknown probability <span class="arithmatex">\(\theta_i\)</span>), one can use independent Beta priors <span class="arithmatex">\(\theta_i \sim \mathrm{Beta}(\alpha_i, \beta_i)\)</span> for each arm <span class="arithmatex">\(i\)</span>. When an arm is played and a reward observed, the prior for that arm is updated via Bayesâ€™ rule to a posterior. Thompson Sampling then selects an arm by drawing one sample from each armâ€™s posterior distribution for the mean and then choosing the arm with the highest sampled mean. Concretely:
- For each arm <span class="arithmatex">\(i\)</span>, sample <span class="arithmatex">\(\tilde{\mu}_i\)</span> from the posterior of <span class="arithmatex">\(\mu_i\)</span> (given all data observed so far for that arm).
- Play the arm <span class="arithmatex">\(I_t = \arg\max_i \tilde{\mu}_i\)</span> that has the highest sampled value.</p>
<p>After observing the reward for arm <span class="arithmatex">\(I_t\)</span>, update that armâ€™s posterior. Repeat.</p>
<p>This procedure intuitively balances exploration and exploitation: arms that are currently uncertain (with a wide posterior) have a higher chance of occasionally yielding a high sampled <span class="arithmatex">\(\tilde{\mu}_i\)</span>, prompting exploration, whereas arms that are likely to be good (posterior concentrated at a high mean) will usually win the sampling competition and be selected.</p>
<p><strong>Derivation (Probability Matching):</strong> Thompson Sampling can be derived as attempting to minimize Bayesian regret (expected regret with respect to the prior). It can be shown that at each step, the probability that TS selects arm <span class="arithmatex">\(i\)</span> is equal to the probability (under the current posterior) that arm <span class="arithmatex">\(i\)</span> is the optimal arm (i.e., has the highest true mean). Thus TS â€œmatchesâ€ the selection probability to the belief of optimality. This is in fact the optimal way to choose if one were to maximize the expected reward at the next play <em>according to the posterior</em>. Another way to see it: TS maximizes <span class="arithmatex">\(\mathbb{E}[\mu_{I_t}]\)</span> given the current posterior by averaging over the uncertainty (it is equivalent to selecting an arm with probability of being best) â€“ this can be shown to be the same decision a Bayesian decision-maker would make for one-step lookahead optimality.</p>
<p><strong>Posterior Updating:</strong> The exact implementation of TS depends on the reward model. In the simplest case of Bernoulli rewards:
- Prior for arm <span class="arithmatex">\(i\)</span>: <span class="arithmatex">\(\mathrm{Beta}(\alpha_i, \beta_i)\)</span>.
- Each success (reward = 1) updates <span class="arithmatex">\(\alpha_i \leftarrow \alpha_i + 1\)</span>; each failure (0) updates <span class="arithmatex">\(\beta_i \leftarrow \beta_i + 1\)</span>.
- Sampling: draw <span class="arithmatex">\(\tilde{\theta}_i \sim \mathrm{Beta}(\alpha_i, \beta_i)\)</span> for each arm, then pick arm with largest <span class="arithmatex">\(\tilde{\theta}_i\)</span>.</p>
<p>For Gaussian rewards with unknown mean (and known variance), one could use a normal prior on the mean and update it with observed rewards (obtaining a normal posterior). For arbitrary distributions, one may use a conjugate prior if available, or approximate posteriors (leading to variants like Bootstrapped Thompson Sampling). The Bayesian nature of TS allows incorporation of prior knowledge and naturally provides a way to handle complicated reward models.</p>
<p><strong>Regret and Theoretical Results:</strong> For a long time, Thompson Sampling was used heuristically without performance guarantees, but recent advances have provided rigorous analyses. In 2012, Agrawal and Goyal proved the first regret bound for Thompson Sampling in the stochastic multi-armed bandit, showing that TS achieves <span class="arithmatex">\(O(\ln n)\)</span> expected regret for certain classes of problems. For instance, in a Bernoulli bandit, TS with Beta(1,1) priors (uniform) was shown to satisfy a bound of the same order as UCB1. Further work tightened these results to show that TS can achieve the Lai-Robbins lower bound constants (it is asymptotically optimal) for Bernoulli and more general parametric reward distributions. In other words, <strong>Thompson Sampling enjoys logarithmic regret</strong> in the stochastic setting, putting it on par with UCB in terms of order-of-growth.</p>
<p>One notable aspect of TS is that it naturally handles the explorationâ€“exploitation trade-off via randomness without an explicit exploration bonus or threshold. This often makes TS very effective empirically; it tends to explore â€œjust enoughâ€ based on the uncertainty encoded in the posterior. It is also versatile and has been extended to various settings (contextual bandits, delayed rewards, etc.). The regret analysis of TS is more involved than UCB â€“ often combining Bayesian priors with frequentist regret arguments or appealing to martingale concentration applied to the posterior â€“ but the end result is that TS is provably good.</p>
<p><strong>Pros and Cons:</strong> Thompson Sampling is conceptually elegant and often empirically superior or comparable to UCB. Itâ€™s easy to implement for simple models (like Beta-Bernoulli). One potential downside is that it requires maintaining and sampling from a posterior; if the reward model is complex, this could be computationally heavy (though approximate methods exist). Another consideration is that TS is a randomized algorithm (the action selection is stochastic by design), so any single run is subject to randomness; however, in expectation it performs well. Unlike UCB, TS inherently uses prior assumptions; if the prior is poor, early behavior might be suboptimal (though the algorithm will eventually correct it as data overwhelms the prior).</p>
<h4 id="6-contextual-bandits">6. Contextual Bandits</h4>
<p>Many practical problems extend the basic multi-armed bandit by introducing a dependency on an observed <strong>context</strong> (also called state or feature) at each decision point. This leads to the <strong>contextual bandit</strong> model (sometimes called bandit with side information or associative bandit).</p>
<p><strong>Definition and Motivation:</strong> In a <em>contextual bandit problem</em>, each round <span class="arithmatex">\(t\)</span> provides the decision-maker with additional information <span class="arithmatex">\(x_t\)</span> (the context) before an arm is chosen. The context <span class="arithmatex">\(x_t\)</span> could be user features in an ad-serving scenario or the current state of a system. Formally:
- Context space <span class="arithmatex">\(\mathcal{X}\)</span> and action (arm) set <span class="arithmatex">\(\mathcal{A} = \{1,\dots,K\}\)</span>.
- At each time <span class="arithmatex">\(t=1,2,\dots\)</span>, a context <span class="arithmatex">\(x_t \in \mathcal{X}\)</span> is observed.
- The agent chooses an arm <span class="arithmatex">\(I_t \in \mathcal{A}\)</span>, based on the context and past observations.
- A reward <span class="arithmatex">\(R_t\)</span> is then obtained, drawn from some distribution dependent on both context and chosen arm: <span class="arithmatex">\(R_t \sim D(\cdot\mid x_t, I_t)\)</span>.
- The goal is to maximize total reward over time, equivalently minimizing regret against the best policy mapping contexts to arms.</p>
<p>In contextual bandits, the optimal action varies with context. For instance, in news recommendations, context is user or time information, and different articles (arms) might be optimal for different users. The bandit algorithm learns a <strong>policy</strong> <span class="arithmatex">\(\pi: \mathcal{X} \to \mathcal{A}\)</span> by trial and error, observing only rewards from chosen arms.</p>
<p><strong>Mathematical Formulation:</strong> Let <span class="arithmatex">\(\pi^*\)</span> be the optimal policy choosing the arm with highest expected reward per context. At time <span class="arithmatex">\(t\)</span>, denote the expected reward for arm <span class="arithmatex">\(a\)</span> in context <span class="arithmatex">\(x\)</span> as:</p>
<div class="arithmatex">\[
\mu_a(x) = \mathbb{E}[R_t \mid x_t=x, I_t=a]
\]</div>
<p>For each context <span class="arithmatex">\(x\)</span>, the optimal arm is:</p>
<div class="arithmatex">\[
a^*(x) = \arg\max_{a\in\mathcal{A}} \mu_a(x)
\]</div>
<p>The contextual regret after <span class="arithmatex">\(n\)</span> rounds is:</p>
<div class="arithmatex">\[
R_n^{\text{ctx}} = \sum_{t=1}^n \left(\mu_{a^*(x_t)}(x_t) - \mu_{I_t}(x_t)\right)
\]</div>
<p>The aim is for <span class="arithmatex">\(R_n^{\text{ctx}}\)</span> to grow sublinearly in <span class="arithmatex">\(n\)</span>. Contexts can be stochastic (i.i.d.) or adversarial. Often, one assumes contexts are i.i.d. or <span class="arithmatex">\(\mu_a(x)\)</span> has structure (like linearity) for tractability.</p>
<p><strong>Comparison with Standard Multi-Armed Bandits:</strong> The standard (context-free) MAB is a special case where the context <span class="arithmatex">\(x_t\)</span> is constant or irrelevant. Contextual bandits must learn a more complex mapping from contexts to actions. The challenge is to learn <span class="arithmatex">\(\mu_a(x)\)</span> from bandit feedback (observing rewards only for chosen arms).</p>
<p>A contextual bandit resembles performing a new bandit problem for each context type, but generalization across contexts is crucial. Typically, a structured assumption for generalization is employed, such as parametric models </p>
<div class="arithmatex">\[
\mu_a(x) = f(x,\theta_a)
\]</div>
<p>For example, linear models:</p>
<div class="arithmatex">\[
\mu_a(x) = x^\top \beta_a \quad\text{or}\quad \mu_a(x) = x^\top \beta
\]</div>
<p>Thus, the contextual bandit blends supervised learning (reward prediction) with exploration-driven bandit methods.</p>
<p>Another difference: exploration never fully stops in contextual bandits, as each new context may be unseen. Algorithms continuously explore new contexts.</p>
<p><strong>Exploration Strategies in Contextual Bandits:</strong> Common strategies include:
- <strong><span class="arithmatex">\(\varepsilon\)</span>-greedy:</strong> Occasionally choosing random arms to explore.
- <strong>Optimism (LinUCB):</strong> Assuming linear rewards, maintaining estimates <span class="arithmatex">\(\hat{\theta}_a\)</span> and selecting:</p>
<div class="arithmatex">\[
I_t = \arg\max_a \left(x_t^\top \hat{\theta}_a + \alpha\sqrt{x_t^\top A_a^{-1} x_t}\right)
\]</div>
<p>achieving regret <span class="arithmatex">\(\tilde{O}(d\sqrt{n})\)</span>.</p>
<ul>
<li><strong>Thompson Sampling:</strong> Placing a prior on parameters, sampling from the posterior, and selecting the best sampled arm per context, also achieving <span class="arithmatex">\(\tilde{O}(d\sqrt{n})\)</span> regret.</li>
<li><strong>Epoch-Greedy (Policy Learning):</strong> Allocating periods for exploration and re-training empirical policy, achieving <span class="arithmatex">\(O(n^{2/3})\)</span> regret or better.</li>
</ul>
<p><strong>Directed exploration:</strong> Contextual bandits require more directed exploration. Random exploration is inefficient due to context complexity. Algorithms use structured exploration based on predictive uncertainty (UCB).</p>
<p><strong>Regret in Contextual Bandits:</strong> Regret bounds typically:
- Linear contextual bandit: <span class="arithmatex">\(\tilde{O}(d\sqrt{n})\)</span>
- Finite policy classes: <span class="arithmatex">\(O(\sqrt{|\Pi|n\log(n)})\)</span></p>
<p>Complex policy spaces yield higher regret unless additional structural assumptions are provided.</p>
<h4 id="authors">Author(s)</h4>
<div class="grid cards">
<ul>
<li><img align="left" alt="Instructor Avatar" src="/assets/images/staff/Arshia-Gharooni.jpg" width="150" />
    <span class="description">
        <p><strong>Arshia Gharooni</strong></p>
        <p>Teaching Assistant</p>
        <p><a href="mailto:arshiyagharoony@gmail.com">arshiyagharoony@gmail.com</a></p>
        <p>
        <a href="https://x.com/Arshia_Gharooni" target="_blank"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg></span></a>
        <a href="https://github.com/SilentDrift" target="_blank"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg></span></a>
        <a href="https://silentdrift.github.io/" target="_blank"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg></span></a>
        </p>
    </span></li>
</ul>
</div>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="..." target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


<script src="https://giscus.app/client.js"
        data-repo="DeepRLCourse/DeepRLCourse.github.io"
        data-repo-id="R_kgDOMPOFbQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOMPOFbc4CmGY6"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made with â¤ï¸ in Robust and Interpretable Machine Learning Lab
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:deeprlcourse@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2zm-2 0-8 5-8-5zm0 12H4V8l8 5 8-5z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/DeepRLCourse" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@DeepRLCourse" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/DeepRLCourse" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://t.me/DeepRLCourse" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m115 168.7c-3.7 39.2-19.9 134.4-28.1 178.3-3.5 18.6-10.3 24.8-16.9 25.4-14.4 1.3-25.3-9.5-39.3-18.7-21.8-14.3-34.2-23.2-55.3-37.2-24.5-16.1-8.6-25 5.3-39.5 3.7-3.8 67.1-61.5 68.3-66.7.2-.7.3-3.1-1.2-4.4s-3.6-.8-5.1-.5c-2.2.5-37.1 23.5-104.6 69.1-9.9 6.8-18.9 10.1-26.9 9.9-8.9-.2-25.9-5-38.6-9.1-15.5-5-27.9-7.7-26.8-16.3.6-4.5 6.7-9 18.4-13.7 72.3-31.5 120.5-52.3 144.6-62.3 68.9-28.6 83.2-33.6 92.5-33.8 2.1 0 6.6.5 9.6 2.9 2 1.7 3.2 4.1 3.5 6.7.5 3.2.6 6.5.4 9.8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.integrate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>